# 20240527 

## JBF2019

<div class = 'centerwords'>

Characterizing the financial cycle: Evidence from a frequency domain analysis

</div>

我们一般说到周期，指的都是经济周期，约为 2-8 年，但是这篇文章说还有个一个周期叫金融周期（Financial cycles），8-30 年，文章说这个东西更重要。

> Existing work argues that the financial cycle is **considerably** longer in duration and larger in amplitude than the business cycle

文章指出了时域表示和频域表示之间的联系，并没有直接从频域入手，而是使用了 indirect 的方法，同时考虑了频域和时域：

> In order to combine the advantages of both representations, we apply the indirect spectrum estimation approach. In a nutshell, **we do the estimation in the time domain and transform the estimated processes into the frequency domain** to analyze their cyclical properties.

文章使用 ARMA 来估计 $y_t$

$$
\begin{equation}
    A(L)y_t=\delta+B(L)\varepsilon_t,\quad\varepsilon_t\sim\mathrm{WN}(0,\sigma_\varepsilon^2)\mathrm{~,}
\end{equation}
$$

其中 $A(L), B(L)$  都是 lag operator。如果 $y_t$ 是平稳的，则有


$$
\begin{equation}
    y_t-\mu=\frac{B(L)}{A(L)}\varepsilon_t,\quad\mu=\frac\delta{A(1)}.
\end{equation}
$$

这里的 $B(L)/A(L)$ 就像一个 **filter**，将白噪声序列 transform 为时间序列 $y_t$，其中 $y_t$ 的频谱可以表示为

$$
\begin{equation}
    f_y(\lambda)=\frac{|B(e^{-i\lambda})|^2}{|A(e^{-i\lambda})|^2}f_\varepsilon(\lambda), \quad f_\varepsilon(\lambda)=\frac{\sigma_\varepsilon^2}{2\pi}
\end{equation}
$$

$\lambda\in[-\pi,\pi]$ 代表频率，$|B(e^{-i\lambda)}|^2/|A(e^{-i\lambda})|^2$ 代表 **转移函数**。

**那么为什么不直接对 $y_t$ 做傅里叶分解得到频谱呢？**文章指出

> Directly estimating spectra requires very long time series to get precise estimates.

## Cycle & Non-Cycle

对于每一个因子，我进行了两组估计，

1. 过去收益率平均值回归，用当期收益率对过去两个月至十二个月的平均值进行回归

<div class = 'centertable'>

|             |   Mkt-RF |   Mkt-RF_t |    SMB |   SMB_t |    HML |   HML_t |
|:------------|---------:|-----------:|-------:|--------:|-------:|--------:|
| const       |    0.536 |      2.924 |  0.161 |   1.387 |  0.202 |   1.754 |
| lag_2_mean  |   -0.053 |     -0.576 |  0.22  |   **2.333** |  0.189 |   **1.946** |
| lag_3_mean  |    0.061 |      0.373 | -0.119 |  -0.717 | -0.085 |  -0.487 |
| lag_4_mean  |   -0.209 |     -0.948 | -0.281 |  -1.276 |  0.297 |   1.277 |
| lag_5_mean  |    0.573 |     **2.079** |  0.144 |   0.52  | -0.137 |  -0.471 |
| lag_6_mean  |   -0.473 |     -1.432 |  0.144 |   0.433 | -0.126 |  -0.362 |
| lag_7_mean  |    0.248 |      0.644 | -0.116 |  -0.298 | -0.112 |  -0.275 |
| lag_8_mean  |    0.222 |      0.505 |  0.378 |   0.853 |  0.23  |   0.494 |
| lag_9_mean  |   -0.555 |     -1.117 | -0.325 |  -0.653 |  0.079 |   0.15  |
| lag_10_mean |    0.157 |      0.284 | -0.115 |  -0.208 | -0.517 |  -0.884 |
| lag_11_mean |   -0.139 |     -0.23  | -1.1   |  -1.809 |  0.508 |   0.789 |
| lag_12_mean |    0.223 |      0.491 |  1.42  |   **3.132** | -0.06  |  -0.132 |

|             |    RMW |   RMW_t |    CMA |   CMA_t |    Mom |   Mom_t |   ST_Rev |   ST_Rev_t |
|:------------|-------:|--------:|-------:|--------:|-------:|--------:|---------:|-----------:|
| const       |  0.222 |   2.535 |  0.195 |   2.368 |  0.616 |   3.492 |    0.476 |      3.536 |
| lag_2_m  |  0.358 |   **3.765** |  0.138 |   1.433 | -0.011 |  -0.117 |   -0.172 |     **-1.923** |
| lag_3_m  | -0.469 |  **-2.686** |  0.227 |   1.333 | -0.107 |  -0.654 |    0.195 |      1.257 |
| lag_4_m  |  0.29  |   1.244 | -0.054 |  -0.238 |  0.143 |   0.651 |   -0.211 |     -1.02  |
| lag_5_m  | -0.307 |  -1.054 | -0.635 |  **-2.238** | -0.279 |  -1.02  |   -0.184 |     -0.71  |
| lag_6_m | -0.255 |  -0.725 |  0.616 |   1.81  |  0.731 |   **2.234** |    0.335 |      1.073 |
| lag_7_m  |  0.621 |   1.509 |  0.166 |   0.42  | -0.418 |  -1.096 |    0.228 |      0.628 |
| lag_8_m  |  0.477 |   1.018 | -0.652 |  -1.438 |  0.085 |   0.195 |   -0.486 |     -1.168 |
| lag_9_m  | -0.805 |  -1.53  | -0.238 |  -0.467 |  0.278 |   0.565 |   -0.496 |     -1.061 |
| lag_10_m | -0.88  |  -1.505 |  0.059 |   0.104 | -0.001 |  -0.002 |    0.881 |      1.695 |
| lag_11_m |  **2.28**  |   **3.557** |  1.316 |   **2.087** | -1.256 |  **-2.089** |   -0.09  |     -0.158 |
| lag_12_m | -1.078 |  **-2.362** | -0.676 |  -1.48  |  0.82  |   1.806 |   -0.044 |     -0.097 |


</div>

2. 过去收益率回归，用当期收益率对过去一个月至十二个月单期收益率进行回归

<div class = 'centertable'>

|        |   Mkt-RF |   Mkt-RF_t |    SMB |   SMB_t |    HML |   HML_t |
|:-------|---------:|-----------:|-------:|--------:|-------:|--------:|
| const  |    0.568 |      2.799 |  0.214 |   1.364 |  0.277 |   1.763 |
| ar.L1  |    0.054 |      1.595 |  0.06  |   **2.103** |  0.158 |   **5.025** |
| ar.L2  |   -0.052 |     -1.435 |  0.048 |   1.322 |  0.046 |   1.526 |
| ar.L3  |    0.033 |      1.004 | -0.055 |  -1.596 |  0.013 |   0.464 |
| ar.L4  |    0.002 |      0.063 | -0.016 |  -0.492 |  0.038 |   1.33  |
| ar.L5  |    0.06  |      1.658 |  0.053 |   1.435 | -0.039 |  -1.277 |
| ar.L6  |   -0.058 |     -1.61  |  0.025 |   0.617 | -0.006 |  -0.182 |
| ar.L7  |    0.029 |      0.728 |  0.001 |   0.026 |  0.009 |   0.313 |
| ar.L8  |   -0.017 |     -0.435 |  0.018 |   0.431 |  0.026 |   0.815 |
| ar.L9  |   -0.038 |     -1.086 | -0.028 |  -0.702 | -0     |  -0.005 |
| ar.L10 |    0.023 |      0.621 |  0.008 |   0.206 | -0.009 |  -0.264 |
| ar.L11 |    0.001 |      0.038 |  0.018 |   0.472 |  0.041 |   1.299 |
| ar.L12 |    0.021 |      0.537 |  0.117 |   **3.295** | -0.006 |  -0.217 |

|        |    RMW |   RMW_t |    CMA |   CMA_t |    Mom |   Mom_t |   ST_Rev |   ST_Rev_t |
|:-------|-------:|--------:|-------:|--------:|-------:|--------:|---------:|-----------:|
| const  |  0.288 |   2.448 |  0.267 |   2.394 |  0.607 |   3.307 |    0.456 |      3.577 |
| ar.L1  |  0.17  |   **8.813** |  0.13  |   **4.282** |  0.046 |   1.935 |   -0.056 |     **-2.306** |
| ar.L2  | -0.013 |  -0.469 |  0.053 |   1.612 | -0.053 |  -1.775 |   -0.067 |     **-2.719** |
| ar.L3  | -0.085 |  **-2.775** |  0.027 |   0.89  |  0.007 |   0.218 |    0.023 |      0.88  |
| ar.L4  |  0.062 |   **2.795** | -0.054 |  -1.548 |  0.035 |   1.155 |   -0.041 |     -1.401 |
| ar.L5  | -0.028 |  -1.175 | -0.036 |  -1.223 |  0     |   0.009 |    0.012 |      0.375 |
| ar.L6  |  0.054 |   1.756 |  0.086 |   **2.936** |  0.059 |   1.815 |    0.048 |      1.581 |
| ar.L7  |  0.081 |   **2.886** | -0.019 |  -0.588 | -0.067 |  -1.918 |   -0.007 |     -0.195 |
| ar.L8  | -0.003 |  -0.16  | -0.038 |  -1.165 |  0.002 |   0.064 |   -0.039 |     -1.175 |
| ar.L9  | -0.051 |  **-2.062** |  0.047 |   1.495 | -0.018 |  -0.576 |    0.02  |      0.686 |
| ar.L10 |  0.032 |   0.915 |  0.065 |   **1.991** | -0.044 |  -1.484 |    0.075 |      **2.214** |
| ar.L11 |  0.109 |   **3.576** |  0.064 |   **2.006** | -0.044 |  -1.273 |   -0.013 |     -0.449 |
| ar.L12 | -0.093 |  **-3.418** | -0.057 |  -1.751 |  0.067 |   **2.019** |   -0.002 |     -0.073 |


</div>

对于每一个因子的收益率，其来源可以拆分为两个部分，自相关性和无条件收益率均值。通过这两张表，我想说明，**在 factor zoo 中，因子可以被分为两类**，有些因子无条件收益率很高，但是自相关性很弱，对于这类因子，应该根据无条件收益率**分配时不变的权重**，但是对于自相关性强，周期性强的因子，应当分配时变的权重，通过时变的权重，就可以提高这些周期性强的因子带来的夏普比率。


<div class = 'centertable'>

|        |  Mean |   Std |   Sharpe |
|:-------|------:|------:|---------:|
| Mkt-RF | 0.578 | 4.492 |    0.129 |
| SMB    | 0.203 | 3.035 |    0.067 |
| HML    | 0.288 | 2.997 |    0.096 |
| RMW    | 0.282 | 2.223 |    0.127 |
| CMA    | 0.269 | 2.075 |    0.13  |
| Mom    | 0.611 | 4.211 |    0.145 |
| ST_Rev | 0.458 | 3.134 |    0.146 |

</div>

对于传统的 PCA 来说，如果是单纯的想要拟合序列波动，那么会选择到方差大的因子，也就是 Mkt，Mom 这些因子，如果是 RP-PCA，加上对于收益率均值的拟合，可以看到，还是选择了 Mkt，Mom 这些因子，因为这些因子的无条件收益率也很高。In a nutshell，在现有的 PCA 应用中，**实际上是忽略了周期性的存在**。

想要捕捉到周期性的成分，就需要一个指标，指标应该是什么，需要进一步的思考。

