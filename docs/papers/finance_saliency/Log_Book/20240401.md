# Comparisons 

看完了两篇文章，有一些想法，并尝试了实证。

Wold 中，对于任意序列都可以分解为高频和低频等部分，并且不同频率之间据有**正交性**。在正交性的前提下，低频的协方差就等于协方差的低频部分，如此一来，Wold 和 FDR 分子部分就相同了，那么就主要看一下分母部分。


$$
\text{β}^{LF} =\frac{\mathbb{C}[y_t^{LF},x_t^{LF}]}{\mathbb{V}[x_t^{LF}]} \qquad \text{FDR} : \frac{\mathbb{C}[y_t^{LF},x_t^{LF}]}{\mathbb{C}[y_t,x_t]}
$$


Wold 将序列分为不同频率后，能够得到不同频率对应的 $\beta$，因而构造出了一种因子模型，而 FDR 是计算了不同频率协方差在总协方差的占比，作为一种 sort 指标存在。(也许根据 $\text{β}^{LF}$ 也能进行 sort，但是文章中并没有给出。)

正交性的概念有助于理解，按照空间的角度想象，相当于把一个序列分配到了不同的两两正交的轴上，以低频轴为例，上面有许多资产或因子的低频部分，既然频率相同，那么周期也相同，**此时协方差的大小就衡量了相位差和振幅差的大小**。协方差的大小会随着相位差的增加（直到一个周期）先减少而后增加。

我们想要的是在低频中与市场低频相位差为零的因子，并且振幅越大越好。但是振幅的存在会混淆最终的结果，如果想看相位差，可以看相关系数，相关系数可以避免振幅的影响，也就是纯看相位。对于 FDR 来说，分母除以总协方差，也算是排除一部分振幅的影响，$\frac{\mathbb{C}[y_t^{LF},x_t^{LF}]}{\mathbb{C}[y_t,x_t]}$。纯看相位还有一种方式就是直接计算相位差。

但是计算了低频的相位差后，发现效果并不好，多空两组的 $\alpha$ 都变低了，并且也没有了单调性。

## More thinking

又卡住了，不过做研究要不忘初心，接下来我往回看，想一想最初是想做什么。

**假设1** 所有资产，在所有频率上都会受到 state vector 的影响，state vector 在不同因子上会体现出不同的部分，例如 market 和 stock，与 size 与 stock，低频部分有共同之处，也有不共同之处。原来说的是，我们想要考虑所有的因子和资产的频率，那也就是说，想要挖掘有关 state vector 的信息。

**假设2** 经过老师上周五对 transformer 空间上的提点，我想，仅考虑 market 因子时，每个股票都和 market 有一个协方差频率分解结果，最后计算成了占比，那么也就是每个股票都可以表示为十维的向量，在空间中分布，我们关注的是在其中低频轴上的 cluster 情况，接着我们认为低频轴上与资产收益率有正相关的关系，那么仅考虑低频轴一个轴也许是不够的，实证效果来看低频也有会失效和回撤极大的时候。

对于这两个假设，我分别有一些想法。

对于假设1，在意识到了不同因子频率内有重合之处时，我们尝试了将因子正交化，再将对应频率相加，可是在这个过程中，很难说新因子的低频部分结构如何。我们还尝试了使用 $\mu = \Sigma b$ 来合成多因子，可是这种方式看起来没有那么大的 capability 来完成这一点。我的想法是，如果能找到一种方式，例如，对于低频，将不同因子的低频综合，保留共有的部分，合成有定价信息的部分，最终得到合成后的频率结果，就可以说是更加直接的实现了我们想要的假设1。这一步可以通过 attention 机制来实现，attenton 机制是一种能够有效综合低频内不同成分的方法。

对于假设2，除了要综合不同因子，在不同频率内【within frequency】实现增强，还要综合不同频率【cross frequency】，因为低频也有失效的时候，这里也可以采用 attention 机制。

综上，通过假设 1 和假设 2，我们最终实现了一个考虑所有频率，所有因子的结合体，那么是一个什么形态呢？

如果以 wold decomposition 的角度，最终就是一个投资组合，对于所有因子序列有一个权重，对于因子内的所有频率成分也有一个权重。如果是 FDR 的角度，那么就是一个特征，基于这个特征，进行排序？

具体一点，现有的数据，对于 $N$ 只股票来说，每一只都能和 $K$ 个因子计算协方差，并且协方差可以分解为 $M$ 个频率，这样数据的大小就是 $N \times (K \times M)$。

对于这个数据，采取什么样的 attention 机制，如何设计，如果老师觉得这个思路可行，就接下来进一步研究。







