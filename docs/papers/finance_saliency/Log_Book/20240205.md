# Hyper ridge gamma and monthly GLS

## Hyper ridge gamma

对于 ridge 超参数的选取，与李煌师兄简单讨论了一下后，觉得并不适用 K-fold。例如将十年数据分为 5-fold，使用八年的数据 train，两年的数据 valid，此时流程为：

1. 使用八年的 train data 进行 ridge 回归得到风险价格 $b$
2. 使用两年的 valid data 利用 $b$ 进行频率协方差分解计算

> 注意，此时 train data 并没有进行频率计算，而 valid data 也没有进行风险价格的计算。

然而，频率分解要求最少五年的数据，因此，计算 valid 步骤所需的数据量非常大，并且逻辑上有所不通。因此，在优化过程中并没有使用 k-fold，而是采用了如下算法：

1. 在 $t$ 时间节点，使用过去六年至过去一年数据 ($t-72 \sim t-13$) 做 ridge 回归得到风险价格 $b$ 
2. 基于第一步得到的风险价格，在 $t-12 \sim t-1$ 的每个时点，使用过去五年数据进行频率分解计算多因子频率
3. 在 $t-12 \sim t-1$ 的每个时点，根据得到的频率进行 sort 构造组合，计算夏普比率
4. 选择夏普比率最高的组合对应的超参数 gamma，在 test data 上计算构造组合

然而，目前这个过程跑的非常之慢，原本不设置任何超参数的情况下大约 20 分钟跑完从 1958-2018 的数据，现在最外层循环为 gamma 循环，初始设置了从 0.01-0.001 中的等间距 20 个数，内层循环是验证集每个时点的频率分解计算，总共计算 12 次，因此，现在的运算时长是原来的 240 倍，也就是 80 个小时，这无疑是行不通的。

于是我现在把超参数的选择设置为从 0.01-0.001 总共 5 个数，valid 为半年，整体数据时长从 1995 年开始，明天早上看看结果。


## monthly GLS

对于 GLS 方法，即使使用了月频收益率进行估计，得到的估计值也十分 crazy，究其原因，还是协方差矩阵的估计仍然不是正定的，不过感觉这是一个十分常见的问题，接下来要从论文里看看别人是如何使用协方差估计的。














